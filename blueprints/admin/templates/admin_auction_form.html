<!-- Admin Auction Form Template -->
{% extends "base.html" %}

{% block title %}{{ title }}{% endblock %}

{% block content %}
<section>
    <h1>{{ title }}</h1>
    <!-- Form för att add eller edit en auktion -->
    <form method="POST">

        <div>
            <label for="title" class="form-label">Title</label>
            <input type="text" placeholder="Example Nightstand" id="title" name="title"
                value="{{ auction.title if auction else '' }}" required>
        </div>

        <div class="mb-3">
            <label for="category" class="form-label">Category</label>
            <input type="text" placeholder="Example furniture" id="category" name="category"
                value="{{ auction.category if auction else '' }}" required>
        </div>

        <div>
            <div>
                <label for="starting_bid" class="form-label">Starting Bid in $</label>
                <input type="text" placeholder="100.00" id="starting_bid" name="starting_bid"
                    value="{{ auction.starting_bid if auction else '' }}" required>
            </div>
            <div>
                <label for="end_at" class="form-label">Ends At</label>
                <input type="datetime-local" id="end_at" name="end_at"
                    value="{{ auction.end_at if auction else '' }}" required>
            </div>
            <div>
                <label for="image_url" class="form-label">Image URL</label>
                <input type="text" placeholder="Optional" id="image_url" name="image_url"
                    value="{{ auction.image_url if auction else '' }}" >
            </div>
        </div>

        <div>
            <label for="description" class="form-label">Description</label>
            <textarea id="description" placeholder="Describe your item" name="description" rows="4"
                required>{{ auction.description if auction else '' }}</textarea>
        </div>
        <!-- Submit knapp -->
        <button type="submit" class="button">
            {{ 'Save Changes' if auction else 'Add auction' }}
        </button>
        <!-- Cancel knapp -->
        <a href="{{ url_for('admin_bp.admin_auctions_list') }}" class="button-secondary">Cancel</a>
    </form>
    <!-- Bud historik sektion -->
    <h2>Bidding history</h2>
    <ol>
        {% for bid in history %}
        <li>${{ bid.amount }} — {{ bid.created_at.strftime("%d %b %Y kl %H:%M") }}
            <form action="{{ url_for('admin_bp.admin_delete_bid', bid_id=bid.id) }}" method="POST" style="display:inline;">
            <button type="submit" class="button small danger button-far-right"
                onclick="return confirm('Are you sure you want to delete this bid?');"
                aria-label="Delete bid for {{ auction.title }}">Delete bid</button>
        </form>
        </li>
        
        {% else %}
        <li>No bids yet.</li>

        {% endfor %}
    </ol>

    {% if auction %}
    <!-- Reactions sektion -->
    <h3>Reactions</h3>

    <p>
        <b>Likes:</b> {{ likes }}
    <form method="post" action="{{ url_for('admin_bp.admin_likes_plus', auction_id=auction.id) }}"
        style="display:inline;">
        <!-- Knapp för att öka likes -->
        <button class="button" type="submit">+</button>
    </form>
    <form method="post" action="{{ url_for('admin_bp.admin_likes_minus', auction_id=auction.id) }}"
        style="display:inline;">
        <!-- Knapp för att minska likes -->
        <button class="button" type="submit">-</button>
    </form>
    </p>

    <p>
        <b>Dislikes:</b> {{ dislikes }}
    <form method="post" action="{{ url_for('admin_bp.admin_dislikes_plus', auction_id=auction.id) }}"
        style="display:inline;">
        <!-- Knapp för att öka dislikes -->
        <button class="button" type="submit">+</button>
    </form>
    <form method="post" action="{{ url_for('admin_bp.admin_dislikes_minus', auction_id=auction.id) }}"
        style="display:inline;">
        <!-- Knapp för att minska dislikes -->
        <button class="button" type="submit">-</button>
    </form>
    </p>
    {% endif %}




</section>
{% endblock %}